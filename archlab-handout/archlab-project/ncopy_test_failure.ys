
            .pos 0
            irmovq stack, %rsp
            irmovq data_to_copy, %rdi
            irmovq data_dst, %rsi
            irmovq $16, %rdx

            call ncopy
            halt
            nop
            nop
            nop
            nop
            nop
        
        ################################################################################
# ncopy.ys - Copy a src block of len words to dst.
# Return the number of positive words (>0) contained in src.
#
# Include your name and ID here.
#王泽恺 2400013155
# Describe how and why you modified the baseline code.
#   xorq %rax,%rax      # count = 0;
#   andq %rdx,%rdx      # len <= 0?
#   jle Done        # if so, goto Done:

#Loop:  
#   mrmovq (%rdi), %r10 # read val from src...
#   rmmovq %r10, (%rsi) # ...and store it to dst
    #andq %r10, %r10        # val <= 0?
    #jle Npos       # if so, goto Npos:
    #irmovq $1, %r10
    #addq %r10, %rax        # count++

#Npos:  irmovq $1, %r10
    #subq %r10, %rdx        # len--
    #irmovq $8, %r10
    #addq %r10, %rdi        # src++
    #addq %r10, %rsi        # dst++
    #andq %rdx,%rdx     # len > 0?
    #jg Loop            # if so, goto Loop:
#Done:
    #ret
################################################################################
# Do not modify this portion
# Function prologue.
# %rdi = src, %rsi = dst, %rdx = len
ncopy:
################################################################################
# You can modify this portion
    iaddq $-8,%rdx
    jl handle_rem
loop_unroll:
    mrmovq (%rdi),%r8
    mrmovq 8(%rdi),%r9
    mrmovq 16(%rdi),%r10
    mrmovq 24(%rdi),%r11
    mrmovq 32(%rdi),%r12
    mrmovq 40(%rdi),%r13
    mrmovq 48(%rdi),%r14
    mrmovq 56(%rdi),%rcx
   # process r8
    andq %r8,%r8
    rmmovq %r8,(%rsi)
    jle LU1
    iaddq $1,%rax
LU1:
    andq %r9,%r9
    rmmovq %r9,8(%rsi)
    jle LU2
    iaddq $1,%rax
LU2:
    andq %r10,%r10
    rmmovq %r10,16(%rsi)
    jle LU3
    iaddq $1,%rax
LU3:
    andq %r11,%r11
    rmmovq %r11,24(%rsi)
    jle LU4
    iaddq $1,%rax
LU4:
    andq %r12,%r12
    rmmovq %r12,32(%rsi)
    jle LU5
    iaddq $1,%rax
LU5:
    andq %r13,%r13
    rmmovq %r13,40(%rsi)
    jle LU6
    iaddq $1,%rax
LU6:
    andq %r14,%r14
    rmmovq %r14,48(%rsi)
    jle LU7
    iaddq $1,%rax
LU7:
    andq %rcx,%rcx
    rmmovq %rcx,56(%rsi)
    jle LU8
    iaddq $1,%rax
LU8:
    iaddq $64,%rdi
    iaddq $64,%rsi
    iaddq $-8,%rdx
    andq %rdx,%rdx
    jg loop_unroll
handle_rem:
    iaddq $4,%rdx
    jl bi_r04
bi_r47:
    iaddq $-2,%rdx
    jl bi_r45
bi_r67:
    mrmovq 40(%rdi),%r8
    je bi_r6
    mrmovq 48(%rdi),%r8
    jmp bi_r7
bi_r45:
    iaddq $1,%rdx
    mrmovq 32(%rdi),%r8
    je bi_r5
    mrmovq 24(%rdi),%r8
    jmp bi_r4
bi_r04:#[-2,1]
    iaddq $2,%rdx
    jl bi_r01
bi_r23:
    mrmovq 8(%rdi),%r8
    je bi_r2
    mrmovq 16(%rdi),%r8
    jmp bi_r3
bi_r01:
    iaddq $1,%rdx
    mrmovq (%rdi),%r8
    je bi_r1
    jmp done
bi_r7:
    andq %r8,%r8
    rmmovq %r8,48(%rsi)
    mrmovq 40(%rdi),%r8
    jle bi_r6
    iaddq $1,%rax
bi_r6:
    andq %r8,%r8
    rmmovq %r8,40(%rsi)
    mrmovq 32(%rdi),%r8
    jle bi_r5
    iaddq $1,%rax
bi_r5:
    andq %r8,%r8
    rmmovq %r8,32(%rsi)
    mrmovq 24(%rdi),%r8
    jle bi_r4
    iaddq $1,%rax
bi_r4:
    andq %r8,%r8
    rmmovq %r8,24(%rsi)
    mrmovq 16(%rdi),%r8
    jle bi_r3
    iaddq $1,%rax
bi_r3:
    andq %r8,%r8
    rmmovq %r8,16(%rsi)
    mrmovq 8(%rdi),%r8
    jle bi_r2
    iaddq $1,%rax
bi_r2:
    andq %r8,%r8
    rmmovq %r8,8(%rsi)
    mrmovq (%rdi),%r8
    jle bi_r1
    iaddq $1,%rax
bi_r1:
    andq %r8,%r8
    rmmovq %r8,(%rsi)
    jle done
    iaddq $1,%rax
done:
    ret

# In grader, we will add a "trap: jmp trap" here, which traps your program in an
# infinite loop. Thus your function should always return instead of falling
# through till the end of the source code :)


        # do not fall through to the end of the source!
        # Otherwise you will encounter this trap :)
        trapititit: jmp trapititit

            .pos 0x1000 # source code + stack limits to 4kb
            .align 8
        stack:
        data_to_copy:
            .quad 0xe0b074950d67cc75
.quad 0x8d3d147e40fd0004
.quad 0xb5239ca606eac620
.quad 0xa70694cfabdce352
.quad 0x93679ea6f82d0fad
.quad 0xe3b1613953f00ef4
.quad 0x37196cc113e0c1d8
.quad 0x74ee879f9764bd36
.quad 0x92f89fc253749e12
.quad 0x473953837908cdf7
.quad 0x256244f25e73ce3d
.quad 0x5b3043b3306bc196
.quad 0xbd4f0cd4fd732b28
.quad 0x5563f86ebcb362a7
.quad 0xc2fd40f3f91a7719
.quad 0xad120d752e5ea8fd
        data_dst:
        